<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Jul 18, 2013
 | Rendered using Apache Maven Fluido Skin 1.2.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SiteStory  Web Archive - 
   SiteStory  TimeGate Redirector Getting Started Guide</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido.min.js"></script>

    
    <meta name="Date-Revision-yyyymmdd" content="20130718" />
    <meta http-equiv="Content-Language" content="en" />
    
          <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-33797706-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://mementoweb.github.com/SiteStory/" id="bannerLeft">
                                                                                                <img src="images/SiteStory_test-1.png"  alt="Transactional Web Archive" width="100" height="100"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="http://www.mementoweb.org/" id="bannerRight">
                                                                                                <img src="images/mementologo.png"  alt="The Prototyping Team of the Research Library of the Los Alamos National Laboratory" width="100" height="100"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2013-07-18</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.0</li>
                      
                
            
      
                                  
    <li class="pull-right">              <a href="http://www.mementoweb.org/" class="externalLink" title="Memento">Memento</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="http://httpd.apache.org/docs/2.2/filter.html" class="externalLink" title="Apache Filters">Apache Filters</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="http://archive-access.sourceforge.net/projects/wayback/administrator_manual.html" class="externalLink" title="Wayback">Wayback</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="http://addons.mozilla.org/en-US/firefox/addon/mementofox/" class="externalLink" title="MementoFox">MementoFox</a>
  </li>

                        </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                                    <h3>Overview</h3>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Description and Usage">Description and Usage</a>
            </li>
                  <li class="none">
                          <a href="getStarted.html" title="Geting Started">Geting Started</a>
            </li>
                  <li class="none">
            <strong>TimeGate Redirector</strong>
          </li>
                  <li class="none">
                          <a href="putprotocol.html" title="Put Protocol">Put Protocol</a>
            </li>
                  <li class="none">
                          <a href="testbed.html" title="Testbed">Testbed</a>
            </li>
                  <li class="none">
                          <a href="apidocs/index.html" title="API">API</a>
            </li>
                  <li class="none">
                          <a href="demo.html" title="Demo">Demo</a>
            </li>
                  <li class="none">
                          <a href="http://mementoweb.github.com/SiteStory/repository/gov/lanl/archive/sitestory/1.0/" class="externalLink" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="Acknowledgments.html" title="Acknowledgments">Acknowledgments</a>
            </li>
          </ul>
                        <h3>Project Documentation</h3>
                  <ul>
                                                                                                        <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                      
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section" id="sc_TG">
<h2>TimeGate Redirector Interface<a name="TimeGate_Redirector_Interface"></a></h2>
<p> Long-term deployment of a transactional archive will require a more complex distributed set-up.
 For example, several SiteStory  archives can be created on different machines.  Older data can be offloaded from SiteStory to the WARC file format and deployed as <a class="externalLink" href="http://archive-access.sourceforge.net/projects/wayback/downloads.html"> Wayback archive</a> and old data can be purged from the SiteStory Archive instance. The WARC format provides more compact storage in relation to  total number of files in the file system. For the web servers  with very dynamic pages,  total number of files in SiteStory Archive vs inode disk parameter can be an important indicator of the need to offload data to a Wayback archive or start a new SiteStory Archive at a new disk. The archiving setup involving data distribution between  SiteStory and IA Wayback  archives is demonstrated here. Please note that Wayback software supports the Memento interface, see <a href="wayback_memento.html"> Wayback Memento install how-to</a> for more information.</p> <p> To make a Memento client work seamlessly with multiple archives, the TimeGate Redirector   interface is provided. TimeGate Redirector dispatches a Memento client to the correct TimeGate,  depending on the date requested in the  Accept-datetime link header.</p>
  <p> <p>Setting up a TimeGate Redirector server under Tomcat is straightforward. The server is contained in a single WAR file named &quot;tg-redirector.war&quot;. The installation therefore only consists of  editing  a configuration file. Once you copied the WAR file into the [TOMCAT-HOME]/webapps directory, you can find the timegates.xml file   in the [TOMCAT-HOME]/webapps/tg-redirector/WEB-INF/classes directory. Restart Tomcat after editing the timegates.xml file.  </p> From the example below we can see that archived data is distributed between the Wayback archive ( timegate:http://lanlproto.santafe.edu:8080/memento/timegate/) and SiteStory (timegate : http://www.theresourcedepot.com/000010/timegate/).
</p>
<div class="source"><pre class="prettyprint">

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;timegates&gt;
          &lt;timegate uri=&quot;http://lanlproto.santafe.edu:8080/memento/timegate/&quot;&gt;
          &lt;start&gt;Tue\, 27 Mar 2012 22:08:10 GMT&lt;/start&gt;
          &lt;end&gt;Mon\, 09 Apr 2012 23:35:02 GMT&lt;/end&gt;
          &lt;timemap uri=&quot;http://lanlproto.santafe.edu:8080/memento/timemap/link/&quot; /&gt;
          &lt;/timegate&gt;
          &lt;timegate uri=&quot;http://www.theresourcedepot.com/000010/timegate/&quot;&gt;
          &lt;start&gt;Mon\, 09 Apr 2012 23:35:03 GMT&lt;/start&gt;
          &lt;end&gt;Tue\, 19 Apr 2031 12:00:02 GMT&lt;/end&gt;
          &lt;timemap uri=&quot;http://www.theresourcedepot.com/000010/timemap/link/&quot; /&gt;
          &lt;/timegate&gt;
&lt;/timegates&gt;

</pre></div>
<p>If you have multiple archives installed with TimeGate Redirector, you also will need to change the TimeGate link header at your mod_sitestory Apache module config section.
For example, if TimeGate Redirector is installed at http://www.theresourcedepot.com/000010D (war file was renamed to 000010D.war), then the <b>ArchiveTimeGate </b> parameter  needs to point to that URL.<br></br> Example output from TimeGate Redirector: </p>
<div class="source"><pre class="prettyprint">
curl -D my.txt -I  -H &quot;Accept-datetime: Sun, 25 June 2010 12:00:00 GMT&quot; \
http://theresourcedepot.org/000010D/http://www.dans.knaw.nl
HTTP/1.1 302 Moved Temporarily
Date: Wed, 30 May 2012 18:46:13 GMT
Location: http://lanlproto.santafe.edu:8080/memento/timegate/http://www.dans.knaw.nl
Link:&lt;http://www.dans.knaw.nl&gt;;rel=&quot;original&quot;, &lt;http://theresourcedepot.org/000010D/timemap/http://www.dans.knaw.nl&gt;;rel=&quot;timemap index&quot;; type=&quot;application/link-format&quot;
Connection: close
Content-Type: text/plain; charset=UTF-8
Content-Language: nl

</pre></div>
<p>To facilitate  discovery of multiple archives by clients we also provide a TimeMap index service with this application.  Example output from index TimeMap service:  </p>
<div class="source"><pre class="prettyprint">

curl \
 http://theresourcedepot.org/000010D/timemap/http://www.dans.knaw.nl
http://www.dans.knaw.nl&gt;;rel=&quot;original&quot;,
 &lt;http://theresourcedepot.org/000010D/timemap/http://www.dans.knaw.nl&gt;;rel=&quot;self &quot;; type=&quot;application/link-format&quot; ,
 &lt;http://lanlproto.santafe.edu:8080/list/timemap/link/http://www.dans.knaw.nl&gt;;rel=&quot;timemap&quot;; from=&quot;Tue, 27 Mar 2012 22:08:10 GMT&quot;; until=&quot;Mon, 09 Apr 2012 23:35:02 GMT&quot;; type=&quot;application/link-format&quot;,
 &lt;http://www.theresourcedepot.com/000010/timemap/link/http://www.dans.knaw.nl&gt;;rel=&quot;timemap&quot;; from=&quot;Mon, 09 Apr 2012 23:35:03 GMT&quot;; until=&quot;Fri, 21 Sep 2012 20:24:40 GMT&quot;; type=&quot;application/link-format&quot;

</pre></div>
<p>The index TimeMap is constructed from the timemap entries of the timegates.xml config file.   </p>
</div>

                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span16">Copyright &copy;                   2013.
          All Rights Reserved.      
            
      </div>

                          
        
                </div>
    </footer>
  </body>
</html>
